<ng-container *ngIf="deals$ | async as deals;else loading">
    <div>
        <button (click)="createDeal()" class="pf-c-button pf-m-primary" type="button">Create Deal</button>
    </div>
    <stk-list [iterable]="deals"
        [config]="{listType: 'data', itemTemplate: itemTpl}">
    </stk-list>
</ng-container>

<ng-template #itemTpl let-item="item">
    <div>
        <p>
            <a [routerLink]="['/deals/' + item.id]">
                <strong>Deal id{{item.id}}</strong>
                <pre class="explanation" debug>{{item | json}}</pre>
            </a>
        </p>
        <small>Application id: {{item?.application?.id}}</small>
        <div class="pf-l-flex pf-m-wrap">
            <div>Product id: {{item?.application?.product?.id}}</div>
            <div>Loan Type: {{item?.application?.product?.loanType?.name}}</div>
        </div>
    </div>
</ng-template>

<ng-template #loading>
    <span class="pf-c-spinner" role="progressbar" aria-valuetext="Loading...">
        <span class="pf-c-spinner__clipper"></span>
        <span class="pf-c-spinner__lead-ball"></span>
        <span class="pf-c-spinner__tail-ball"></span>
    </span> 
</ng-template>